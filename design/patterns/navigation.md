# Navigation

一致的导航是用户整体体验的基本组成部分。很少有东西能比表现不一致并且出现未预料行为的导航更让用户感觉沮丧的了。Android 3.0 在全局导航行为方面引入了一个重要的变化。完全遵循 `返回及向上` 指南，会让你应用的导航让用户感觉可预料，并且可靠。Android 2.3及之前的系统依赖于系统的返回按钮，支持应用内的导航 。随着 Android 3.0 引入动作栏，第二个导航机制出现 了，即向上按钮，由应用图标和左箭头构成。

## Up vs. Back

向上按钮用于应用内的导航，它基于屏幕之间的层次关系。例如，如果屏幕A显示一些列表项，选择一个项进入屏幕B，那么屏幕B应该提供一个向上按钮，返回屏幕A.

如果屏幕是应用中最顶层的，那么不应该显示向上按钮。

系统返回按钮用于导航，与用户最近使用的屏幕的时间顺序相反。它基于屏幕之间的时序关系，而不是屏幕层次关系。

当之前查看的屏幕同时也是当前屏幕上一层级的屏幕时，按下返回按钮与向上按钮会产生同样的结果，这是经常出现的。然而，向上按钮会将用户保持在应用内部，而返回按钮可以返回主屏幕，甚至另一个应用。

返回按钮也支持一些并非与屏幕到屏幕导航相关的功能：

* 消除浮动窗口
* 消除与环境相关的动作栏，去掉已选择项的高亮
* 隐藏屏幕键盘

## Navigation Within Your App

* Navigating to screens with multiple entry points: 有时候，一个屏幕在应用的层次结构中，并没有一个严格的位置，可以从多个进入点进入，例如设置屏幕可以从应用中的任何其它屏幕进入。在这种情况下，向上按钮应该像返回按钮一样返回之前的屏幕。
* Changing view iwthin a screen: 改变屏幕的视图选项并没有改变向上按钮和返回按钮的行为：屏幕依然处于应用层级的同一位置，并且没有创建新的导航历史。这种视图改变的例子有：
  - 使用标签或者左右滑动切换视图
  - 使用下拉切换视图
  - 过滤列表
  - 排序列表
  - 改变显示特征（例如放大）
* Navigating between sibling screens

当你的应用支持从一系列列表项到列表项详情的导航时，通常也需要支持直接从一个列表项的详情页切换到下一个列表项的详情页，例如，在 Gmail 中，很容易通过左右滑动从同一收件箱中的一个会话切换到另一个会话。像改变屏幕视图一样，这样的导航并不会改变向上或者返回的行为。

然而，一个显著的例外出现在你浏览一系统相关视图，但是这些视图并没有被一个列表绑定在一起，例如，当你浏览应用商店中同一开发者的作品，或者同一艺术家的专辑时。在这种情况下，依次点击链接后会创建一个历史，这会导致返回按钮返回上一个浏览的屏幕。但是向上按钮还是会跳过这些相关屏幕，返回最近的容器屏幕。

你可以基于你对详情页面的了解使向上按钮更“聪明”。扩展一个之前应用商店的例子，设想一下用户从书籍列表进入书籍详情，再进入电影详情，那么从电影详情页面按向上按钮时，可以返回到之前用户没有打开的电影列表项页面。

### Navigation into Your App via Home Screen Widgets and Notifications

你可以使用主屏幕控件或者通知，帮助你的用户直接进入应用层级下层的屏幕。例如，Gmail 的收件箱控件以及新消息，都可以跳过收件箱页面，直接进入会话页面。

在这种情况下，可以像这样处理向上按钮：

* 如果目标屏幕通常都是由应用内特定的屏幕进入，那么向上按钮应该导航到这个屏幕
* 否则，向上屏幕应该导航到应用最上层的屏幕

对返回按钮来说，应该让它的行为可预测。可以向任务栈中插入从当前屏幕到最上层屏幕中间路径中所有的导航，这可以让那些忘记自己是如何进入应用的用户，在退出之前进入最上层的屏幕。

例如， Gmail 的屏幕控件中，有一个按钮可以直接进入写邮件屏幕，这个屏幕的向上或者返回按钮会让用户进入收件箱，在收件箱内返回，会进入主屏幕。

### Indirect notifications

当你的应用想要同时显示关于多种事件的信息时，可以使用单个通知将用户导入一个过渡层界面。这个界面包括了这些事件，并且提供了直接进入应用底层的路径 。这种风格的通知叫做间接通知。

与标准通知不同的是，从间接通知的过渡层界面点击返回按钮时，会让用户返回到通知被触发的地方，返回栈中并没有被插入多余的屏幕。一旦用户从过渡层界面进入应用，向上按钮和返回按钮会像标准通知时的行为一样，在应用内导航，而不是返回过渡层。

例如，用户在 Gmail 中，收到一个日历应用发来的间接通知，点击通知后打开了过渡层界面，这个界面显示了对多个不同事件的提醒。此时，如果点击返回按钮，用户会返回 Gmail。如果点击其中一个特定事件会让用户进入日历应用，并显示事件详情。从事件详情中，向上按钮和返回按钮会将用户带入日历应用最上层的视图。

### Pop-up notifications

弹出式通知绕过了通知中心，直接出现在用户页面。他们很少使用，并且应该在需要即时反馈并且必须打断用户的情况下。例如，Talk 使用这种风格提醒用户，有一个好友邀请你加入一个视频聊天，这个邀请会在几秒后自动消失。

至于导航的行为，弹出式通知与间接通知的过渡层界面非常相似。返回按钮会让弹出式通知消息。如果知道从弹出的通知进入发出通知的应用，向上按钮和返回按钮的行为会和标准通知下相同，在应用内进行导航。

## Navigation Between Apps

Android 系统一个最基本的优势是应用之间可以相互激活的能力，让用户有能力从一个应用直接进入另一个应用。例如一个应用想要拍照，那么它可以激活照相机应用，之后可以返回原来的应用。这对开发者和用户来说都有莫大好处。对开发者来说，可以很容易利用其它应用的代码，对用户来说，可以享受一些常用动作的一致体验。

为了理解应用到应用的导航，理解下面讨论的 Android 框架的行为是非常重要的。

### Activities, tasks, and intents

在 Android 中，活动是一个应用的组成部分，它定义了界面中的信息以及用户可以执行的行为。你的应用包含一系列活动，包括你自己的以及你从其它应用中复用的。

任务是用户为完成某个目标使用的活动序列。一个简单的任务可以使用来自同一应用的多个活动，也可以使用来自不同应用的多个活动。

意图是一种机制，它是一个应用想要在其它应用的帮助下执行某个动作时，发出的一种信号。一个应用的活动可以声明它可以响应哪种意图。对于一些公共的意图，例如“分享”，可能有多个安装的应用可以完成这一请求。

### Example:navigating between apps to support sharing

为了理解活动，任务，和意图如何协同工作，考虑一个应用如何让用户可以通过其它应用分享内容。例如，在主屏幕启动应用商店会开始一个新任务A。在点击应用商店中的书籍去查看它的详情时，用户仍然处于同一个任务中，通过添加活动来扩展它。触发分享动作后，会有一个列表提示用户有哪些已经注册的活动可以处理分享意图。

当用户选择使用 Gmail 进行分享时，Gmail 的编写活动会添加到任务 A 中，没有新的任务被创建。如果 Gmail 在后台有已经运行的任务，并不会对其造成影响。

从编写活动中，发送消息或者点击返回按钮，用户会返回书籍详情活动中。继续点击返回会返回应用商店，最后到达主屏幕。

然而，点击编写活动的向上按钮，表明用户仍然想处于 Gmail 中。Gmail 的会话列表会出现，此时一个新任务 B 会被创建。新任务的最上层总是主屏幕，所以，点击返回按钮会从会话列表到达主屏幕。

任务 A 在后台中保存，用户会在稍后返回到它（例如，通过最近作用屏幕）。如果 Gmail 已经在后台中有自己的任务，它会被任务 B 替换。原来的场景会因为用户的新目标而被抛弃。

当你的应用注册了层级内部的活动，用于处理意图时，参考 Navigation into Your App via Home Screen Widgets and Notification 用于指导你如何指定向上按钮的导航。
